## -*- texinfo -*-
## @deftypefn  {} {} dummy()
##
## This is a dummy function documentation. This file have a lot functions
## and each one have a little documentation. This text is to avoid a warning when
## install this file as part of package.
## @end deftypefn
##
## Set the graphics toolkit and force read this file as script file (not a function file).
##
graphics_toolkit qt;
##


##
##
## Begin callbacks definitions 
##

## @deftypefn  {} {} btn_closeFFanalysis_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_closeFFanalysis control.
##
## @end deftypefn
function btn_closeFFanalysis_doIt(source, callbackdata, ffAnalysisWnd)


% Close window
close(ffAnalysisWnd.figure);

end

## @deftypefn  {} {} btn_RLanalysis_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_RLanalysis control.
##
## @end deftypefn
function btn_RLanalysis_doIt(source, callbackdata, ffAnalysisWnd)

%
% Plot root locus 
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% ----------------------------------
% Plot  root locus
% ----------------------------------
axes(ffAnalysisWnd.ImageLR);
[Kast,Kast_ult,wultimo,GM,wcg,PM]=GHrlocusplot(GH.num{1,1},GH.den{1,1},Kr,1000);
hold off

end

## @deftypefn  {} {} btn_Bodeanalysis_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_Bodeanalysis control.
##
## @end deftypefn
function btn_Bodeanalysis_doIt(source, callbackdata, ffAnalysisWnd)


%
% Plot Bode diagram
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% Plot Bode diagram
% ----------------------------------
axes(ffAnalysisWnd.ImageBodeMag);
delay=0;
flagMagPha='gragicoMag';
[Kast,Kast_ult,wultimo,GM,wcg,PM]=bodeplotMagPha(GH.num{1,1},GH.den{1,1},delay,Kr,flagMagPha);
hold off
axes(ffAnalysisWnd.ImageBodePha);
flagMagPha='gragicoPha';
[Kast,Kast_ult,wultimo,GM,wcg,PM]=bodeplotMagPha(GH.num{1,1},GH.den{1,1},delay,Kr,flagMagPha);
hold off

end

## @deftypefn  {} {} btn_Nyquistanalisis_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_Nyquistanalisis control.
##
## @end deftypefn
function btn_Nyquistanalisis_doIt(source, callbackdata, ffAnalysisWnd)


%
% Plot Nyquist diagram
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% Plot Nyquist diagram
% ----------------------------------
axes(ffAnalysisWnd.ImageNyq);
delay=0;
[Kast,Kast_ult,wultimo,GM,wcg,PM]=GHnyquistplot(GH.num{1,1},GH.den{1,1},delay,Kr);
hold off

end

## @deftypefn  {} {} mapa_GH_GLC_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of mapa_GH_GLC control.
##
## @end deftypefn
function mapa_GH_GLC_doIt(source, callbackdata, ffAnalysisWnd)

%
% Poles-zeros map of open loop transfer funcion G(s)H(s)
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% ----------------------------------
% Poles-zeros map of G(s)H(s)
% ----------------------------------
title_string='Poles-Zeros Map of G(s)H(s)';
legend_ceros_string='Zeros of G(s)H(s)';
legend_polos_string='Poles of G(s)H(s)';

% Plot poles-zeros map
% ----------------------------------
axes(ffAnalysisWnd.ImageZPGH);
xpzmap(title_string,legend_ceros_string,legend_polos_string,GH.num{1,1},GH.den{1,1});
figuraGH=1;

end

## @deftypefn  {} {} mapa_Glc_GLC_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of mapa_Glc_GLC control.
##
## @end deftypefn
function mapa_Glc_GLC_doIt(source, callbackdata, ffAnalysisWnd)

%
% Poles-zeros map of closed loop transfer funcion Gcl(s)
%


% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% Closed loop transfer function
Gcl = minreal(GH/(1+GH));

% ----------------------------------
% Poles-zeros map of Gcl(s)
% ----------------------------------
title_string='Poles-Zeros Map of Gcl(s)';
legend_ceros_string='Zeros of Gcl(s)';
legend_polos_string='Poles of Gcl(s)';


% Plot poles-zeros map
% ----------------------------------
axes(ffAnalysisWnd.ImageZPGLC);
xpzmap(title_string,legend_ceros_string,legend_polos_string,Gcl.num{1,1},Gcl.den{1,1});
figuraGH=2;


%
refresh();

end

## @deftypefn  {} {} btn_LRplus_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_LRplus control.
##
## @end deftypefn
function btn_LRplus_doIt(source, callbackdata, ffAnalysisWnd)


%
% Plot root locus 
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% Plot root locus 
% ----------------------------------
figure
delay=0;
[Kast,Kast_ult,wultimo,GM,wcg,PM]=GHrlocusplot(GH.num{1,1},GH.den{1,1},Kr,1000);
axisx=xlabel('Real G(s)H(s)'); axisy=ylabel('Imag. G(s)H(s)');
set(axisx,'fontsize',14);  
set(axisy,'fontsize',14);

end

## @deftypefn  {} {} btn_Bodeplus_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_Bodeplus control.
##
## @end deftypefn
function btn_Bodeplus_doIt(source, callbackdata, ffAnalysisWnd)


%
% Plot Bode diagram
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

% Plot Bode diagram
% ----------------------------------
figure();
delay=0;
[Kast,Kast_ult,wultimo,GM,wcg,PM]=GHbodeplot(GH.num{1,1},GH.den{1,1},delay,Kr);
 

end

## @deftypefn  {} {} btn_Nyqplus_doIt (@var{source}, @var{callbackdata}, @var{ffAnalysisWnd})
##
## Define a callback for default action of btn_Nyqplus control.
##
## @end deftypefn
function btn_Nyqplus_doIt(source, callbackdata, ffAnalysisWnd)


%
% Plot Nyquist diagram
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])


% Plot Nyquist diagram
% ----------------------------------
figure
delay=0;
[Kast,Kast_ult,wultimo,GM,wcg,PM]=GHnyquistplot(GH.num{1,1},GH.den{1,1},delay,Kr);

end

 
## @deftypefn  {} {@var{ret} = } show_ffAnalysisWnd()
##
## Create windows controls over a figure, link controls with callbacks and return 
## a window struct representation.
##
## @end deftypefn
function ret = show_ffAnalysisWnd()
  _scrSize = get(0, "screensize");
  _xPos = (_scrSize(3) - 1189)/2;
  _yPos = (_scrSize(4) - 673)/2;
   ffAnalysisWnd = figure ( ... 
	'Color', [0.961 0.965 0.969], ...
	'Position', [_xPos _yPos 1189 673], ...
	'Resize', 'on', ...
	'windowstyle', 'normal', ...
	'MenuBar', 'none');
  analisisFF = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','text', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 13, 'FontUnits', 'points', ... 
	'FontWeight', 'bold', ... 
	'HorizontalAlignment', 'left', ... 
	'Position', [350 643 488 20], ... 
	'String', 'Analysis Tools for Feedback Systems', ... 
	'TooltipString', '');
  btn_closeFFanalysis = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 10, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [1067 16 90 22], ... 
	'String', 'Close', ... 
	'TooltipString', '');
  btn_RLanalysis = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 10, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [40 375 137 23], ... 
	'String', 'Root Locus', ... 
	'TooltipString', '');
  btn_Bodeanalysis = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 10, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [425 375 137 23], ... 
	'String', 'Bode', ... 
	'TooltipString', '');
  btn_Nyquistanalisis = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 10, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [805 375 136 23], ... 
	'String', 'Nyquist', ... 
	'TooltipString', '');
  Label_2 = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','text', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'bold', ... 
	'HorizontalAlignment', 'left', ... 
	'Position', [40 411 279 17], ... 
	'String', 'Analysis Based on G(s)H(s)', ... 
	'TooltipString', '');
  Label_3 = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','text', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'bold', ... 
	'HorizontalAlignment', 'left', ... 
	'Position', [40 581 228 17], ... 
	'String', 'Poles-Zeros Maps', ... 
	'TooltipString', '');
  mapa_GH_GLC = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 10, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [40 541 243 22], ... 
	'String', 'Poles-Zeros of G(s)H(s)', ... 
	'TooltipString', '');
  mapa_Glc_GLC = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 10, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [40 501 239 22], ... 
	'String', 'Poles-Zeros of Closed Loop', ... 
	'TooltipString', '');
  ImageZPGH = axes( ...
	'Units', 'pixels', ... 
	'parent',ffAnalysisWnd, ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Ubuntu', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'Position', [425 456 301 144]);
  ImageLR = axes( ...
	'Units', 'pixels', ... 
	'parent',ffAnalysisWnd, ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Ubuntu', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'Position', [40 74 298 259]);
  ImageBodeMag = axes( ...
	'Units', 'pixels', ... 
	'parent',ffAnalysisWnd, ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Ubuntu', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'Position', [425 239 305 94]);
  ImageBodePha = axes( ...
	'Units', 'pixels', ... 
	'parent',ffAnalysisWnd, ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Ubuntu', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'Position', [425 76 304 92]);
  ImageNyq = axes( ...
	'Units', 'pixels', ... 
	'parent',ffAnalysisWnd, ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Ubuntu', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'Position', [810 73 305 260]);
  btn_LRplus = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [340 316 42 22], ... 
	'String', '+', ... 
	'TooltipString', '');
  btn_Bodeplus = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [730 316 43 22], ... 
	'String', '+', ... 
	'TooltipString', '');
  btn_Nyqplus = uicontrol( ...
	'parent',ffAnalysisWnd, ... 
	'Style','pushbutton', ... 
	'Units', 'pixels', ... 
	'BackgroundColor', [0.961 0.965 0.969], ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Arial', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'ForegroundColor', [0.000 0.000 0.000], ... 
	'Position', [1115 316 42 22], ... 
	'String', '+', ... 
	'TooltipString', '');
  ImageZPGLC = axes( ...
	'Units', 'pixels', ... 
	'parent',ffAnalysisWnd, ... 
	'FontAngle', 'normal', ... 
	'FontName', 'Ubuntu', ... 
	'FontSize', 11, 'FontUnits', 'points', ... 
	'FontWeight', 'normal', ... 
	'Position', [815 454 302 149]);

  ffAnalysisWnd = struct( ...
      'figure', ffAnalysisWnd, ...
      'analisisFF', analisisFF, ...
      'btn_closeFFanalysis', btn_closeFFanalysis, ...
      'btn_RLanalysis', btn_RLanalysis, ...
      'btn_Bodeanalysis', btn_Bodeanalysis, ...
      'btn_Nyquistanalisis', btn_Nyquistanalisis, ...
      'Label_2', Label_2, ...
      'Label_3', Label_3, ...
      'mapa_GH_GLC', mapa_GH_GLC, ...
      'mapa_Glc_GLC', mapa_Glc_GLC, ...
      'ImageZPGH', ImageZPGH, ...
      'ImageLR', ImageLR, ...
      'ImageBodeMag', ImageBodeMag, ...
      'ImageBodePha', ImageBodePha, ...
      'ImageNyq', ImageNyq, ...
      'btn_LRplus', btn_LRplus, ...
      'btn_Bodeplus', btn_Bodeplus, ...
      'btn_Nyqplus', btn_Nyqplus, ...
      'ImageZPGLC', ImageZPGLC);


  set (btn_closeFFanalysis, 'callback', {@btn_closeFFanalysis_doIt, ffAnalysisWnd});
  set (btn_RLanalysis, 'callback', {@btn_RLanalysis_doIt, ffAnalysisWnd});
  set (btn_Bodeanalysis, 'callback', {@btn_Bodeanalysis_doIt, ffAnalysisWnd});
  set (btn_Nyquistanalisis, 'callback', {@btn_Nyquistanalisis_doIt, ffAnalysisWnd});
  set (mapa_GH_GLC, 'callback', {@mapa_GH_GLC_doIt, ffAnalysisWnd});
  set (mapa_Glc_GLC, 'callback', {@mapa_Glc_GLC_doIt, ffAnalysisWnd});
  set (btn_LRplus, 'callback', {@btn_LRplus_doIt, ffAnalysisWnd});
  set (btn_Bodeplus, 'callback', {@btn_Bodeplus_doIt, ffAnalysisWnd});
  set (btn_Nyqplus, 'callback', {@btn_Nyqplus_doIt, ffAnalysisWnd});
  dlg = struct(ffAnalysisWnd);

%
% The source code writed here will be executed when
% windows load. Work like 'onLoad' event of other languages.
%

% global variable
global _ltitoolBasePath;

%  Load data
load([_ltitoolBasePath filesep() 'data' filesep() 'loadFFdata'])

%
clc



  ret = ffAnalysisWnd;
end

